# Setup
general:
  workload: nemotron4
  workload_type: pretrain
  gsw_version: '25.08'
  framework: nemo2

container:
  images: 
    - 'nvcr.io#nvidia/nemo:25.07.01'

repositories:
  nemo:
    url: "https://github.com/NVIDIA/NeMo.git"
    commit: "1f422a19d942fab0aa54e3099f4b5752d871cb5d"
  megatron_core:
    url: "https://github.com/NVIDIA/Megatron-LM.git"
    commit: "ac198fc0d60a8c748597e01ca4c6887d3a7bcf3d"
  nemo_run:
    url: "https://github.com/NVIDIA/NeMo-Run.git"
    commit: "2ca3b41a2276f1f24bd462e8baeb28c2536aa7b1"

setup:
  venv_req: true
  dependencies:
    pip:
      - package: nemo
        repo_key: nemo
        install_target: '.[all]'
      - 'scipy<1.13.0'
      - 'bitsandbytes==0.46.0'
      - 'transformers==4.55.4'
      - package: megatron-core
        repo_key: megatron_core
      - package: nemo_run
        repo_key: nemo_run

# Run
run:
  launcher_type: 'nemo'
  launch_script: 'launch.sh'

  gpu_configs:
    gb200:
      model_configs:
        - model_size: '15b'
          dtypes: ['fp8', 'bf16']
          scales: [16, 32, 64, 128, 256, 512]
        - model_size: '340b'
          dtypes: ['fp8', 'bf16']
          scales: [128, 256, 512]
    b200:
      model_configs:
        - model_size: '15b'
          dtypes: ['fp8', 'bf16']
          scales: [16, 32, 64, 128, 256, 512, 1024]
        - model_size: '340b'
          dtypes: ['fp8', 'bf16']
          scales: [128, 256, 512, 1024]

    h100:
      model_configs:
        - model_size: '15b'
          dtypes: ['fp8', 'bf16']
          scales: [16, 32, 64, 128, 256, 512, 1024, 2048]
        - model_size: '340b'
          dtypes: ['fp8', 'bf16']
          scales: [256, 512, 1024, 2048]
