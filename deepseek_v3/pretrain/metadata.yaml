# Setup
general:
  workload: deepseek-v3
  workload_type: pretrain
  gsw_version: '25.10'
  framework: megatron_bridge

container:
  images: 
    - 'nvcr.io#nvidia/nemo:25.09.00'

repositories:
  megatron_bridge:
    url: "https://github.com/NVIDIA-NeMo/Megatron-Bridge.git"
    commit: "7c0ae3fd5488419956105232d859426b4ba253e8"
  megatron_core:
    url: "https://github.com/NVIDIA/Megatron-LM.git"
    commit: "20d73fe76eb03672c02f637e9b47e562b9010d4c"
  nemo_run:
    url: "https://github.com/NVIDIA-NeMo/Run.git"
    commit: "04f900a9c1cde79ce6beca6a175b4c62b99d7982"

setup:
  venv_req: true
  dependencies:
    pip:
      - package: megatron_bridge
        repo_key: megatron_bridge
        install_target: '.'
      - package: megatron_core
        repo_key: megatron_core
      - package: nemo_run
        repo_key: nemo_run

tools:
  cuda_cupti_lib: "13.0.85"

# Run
run:
  launcher_type: 'megatron_bridge'
  launch_script: 'launch.sh'

  gpu_configs:
    gb300:
      model_configs:
        - model_size: '671b'
          dtypes: ['bf16', 'fp8']
          scales: [128, 256, 512]

    gb200:
      model_configs:
        - model_size: '671b'
          dtypes: ['bf16', 'fp8']
          scales: [128, 256, 512]

    b200:
      model_configs:
        - model_size: '671b'
          dtypes: ['bf16', 'fp8']
          scales: [128, 256, 512, 1024]

    h100:
      model_configs:
        - model_size: '671b'
          dtypes:
            bf16: [1024]
            fp8: [512, 1024]
